#include "script_component.hpp"
/*
 * Arguments:
 * 0: guard <OBJECT>
 * 1: gate <OBJECT>
 * 2: gateGuard <OBJECT>
 *
 * Return Value:
 * None
 *
 * Example:
 * [_guard, _gate, _gateGuard] call grad_borderCrossing_fnc_handleQueue;
 *
 * Public: No
 */

params ["_guard", "_gate", "_gateGuard"];

[{
   params ["_args","_handle"]
   _args params ["_guard", "_gate", "_gateGuard"];

   private _queue = _gate getVariable ["GRAD_BorderCrossing_queue", []];
   if (_queue isEqualTo []) exitWith {};
   private _nextVehicle = _queue select 0;
   if (_gateGuard getVariable ["GRAD_BorderCrossing_guard_busy", false]) then {
      if (speed _nextVehicle > 0) then {

      };
   }else{
      if (speed _nextVehicle > 0 && !(_guard getVariable ["GRAD_BorderCrossing_waveThrough", false])) then {

      }else{
         _guard setVariable ["GRAD_BorderCrossing_waveThrough", true];
         [{_this setVariable ["GRAD_BorderCrossing_waveThrough", false];}, _guard, 5] call CBA_fnc_waitAndExecute;
      };
   };
},1,[_guard, _gate, _gateGuard]] call CBA_fnc_addPerFrameHandler;
